<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Kam Tin Seong Assoc. Professor of Information Systems(Practice)">
<meta name="dcterms.date" content="2024-03-09">

<title>Lesson 3: Advanced Spatial Point Patterns Analysis – ISSS626 Geospatial Analytics and Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b76f5e1ad85f87d95165869f8c7e3f49.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626 Geospatial Analytics and Applications</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lesson.html"> 
<span class="menu-text">Lesson Plan</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02-SPPA.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05-GLSA.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06-EHSA.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07-gwr.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex03a.html">
 <span class="dropdown-text">Take-home Exercise 3a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex03b.html">
 <span class="dropdown-text">Take-home Exercise 3b</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-all-about-r" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">All About R</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-all-about-r">    
        <li>
    <a class="dropdown-item" href="../../R.html">
 <span class="dropdown-text">R Resouces</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Quarto.html">
 <span class="dropdown-text">Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../git.html">
 <span class="dropdown-text">git and github</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#content" id="toc-content" class="nav-link active" data-scroll-target="#content">Content</a></li>
  <li><a href="#network-constrained-point-processes" id="toc-network-constrained-point-processes" class="nav-link" data-scroll-target="#network-constrained-point-processes">Network Constrained Point Processes</a></li>
  <li><a href="#network-constrained-kernel-density-estimation-nkde" id="toc-network-constrained-kernel-density-estimation-nkde" class="nav-link" data-scroll-target="#network-constrained-kernel-density-estimation-nkde">Network Constrained Kernel Density Estimation (NKDE)</a></li>
  <li><a href="#network-constrained-kernel-density-estimation-nkde-1" id="toc-network-constrained-kernel-density-estimation-nkde-1" class="nav-link" data-scroll-target="#network-constrained-kernel-density-estimation-nkde-1">Network Constrained Kernel Density Estimation (NKDE)</a>
  <ul class="collapse">
  <li><a href="#planar-kde-versus-nkde" id="toc-planar-kde-versus-nkde" class="nav-link" data-scroll-target="#planar-kde-versus-nkde">Planar KDE versus NKDE</a></li>
  <li><a href="#network-constrained-kernel-density-estimation-nkde-method" id="toc-network-constrained-kernel-density-estimation-nkde-method" class="nav-link" data-scroll-target="#network-constrained-kernel-density-estimation-nkde-method">Network Constrained Kernel Density Estimation (NKDE) method</a></li>
  <li><a href="#nkde-method" id="toc-nkde-method" class="nav-link" data-scroll-target="#nkde-method">NKDE Method</a></li>
  <li><a href="#nkde-method-1" id="toc-nkde-method-1" class="nav-link" data-scroll-target="#nkde-method-1">NKDE Method</a></li>
  <li><a href="#nkde-method-2" id="toc-nkde-method-2" class="nav-link" data-scroll-target="#nkde-method-2">NKDE Method</a></li>
  <li><a href="#nkde-method-3" id="toc-nkde-method-3" class="nav-link" data-scroll-target="#nkde-method-3">NKDE Method</a></li>
  </ul></li>
  <li><a href="#the-three-version-of-nkde" id="toc-the-three-version-of-nkde" class="nav-link" data-scroll-target="#the-three-version-of-nkde">The Three version of NKDE</a>
  <ul class="collapse">
  <li><a href="#simple-method" id="toc-simple-method" class="nav-link" data-scroll-target="#simple-method">Simple method</a></li>
  </ul></li>
  <li><a href="#the-three-version-of-nkde-1" id="toc-the-three-version-of-nkde-1" class="nav-link" data-scroll-target="#the-three-version-of-nkde-1">The Three version of NKDE</a>
  <ul class="collapse">
  <li><a href="#discontinuous-method" id="toc-discontinuous-method" class="nav-link" data-scroll-target="#discontinuous-method">Discontinuous method</a></li>
  </ul></li>
  <li><a href="#the-three-version-of-nkde-2" id="toc-the-three-version-of-nkde-2" class="nav-link" data-scroll-target="#the-three-version-of-nkde-2">The Three version of NKDE</a>
  <ul class="collapse">
  <li><a href="#continue-method" id="toc-continue-method" class="nav-link" data-scroll-target="#continue-method">Continue method</a></li>
  </ul></li>
  <li><a href="#temporal-network-kernel-density-estimate" id="toc-temporal-network-kernel-density-estimate" class="nav-link" data-scroll-target="#temporal-network-kernel-density-estimate">Temporal Network Kernel Density Estimate</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Lesson03-Advanced_SPPA.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 3: Advanced Spatial Point Patterns Analysis</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Dr.&nbsp;Kam Tin Seong<br>Assoc. Professor of Information Systems(Practice) </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Computing and Information Systems,<br>Singapore Management University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">09 Mar 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="content" class="level2">
<h2 class="anchored" data-anchor-id="content">Content</h2>
<ul>
<li>Network Constrained Kernel Density Estimation (NCKDE)
<ul>
<li>Basic concepts of network constrained spatial point patterns</li>
<li>Network Constrained KDE methods</li>
<li>The Three versions of Network Constrained KDE</li>
</ul></li>
<li>Temporal Network Kernel Density Estimation (TNKED)
<ul>
<li>Temporal dimension</li>
<li>Spatial dimension</li>
<li>Spatio-temporal point patterns</li>
</ul></li>
</ul>
<div class="notes">
<p>Welcome to Lesson 3: Spatial Point Pattern Analysis, a family of spatial statistics specially developed to model and to test distribution of spatial point events.</p>
<p>The lesson proceeding is divided into three main section. First, I will share with you what are real world spatial point events. This is followed by explaining the concepts and methods of 1st-order and 2nd-order spatial point patterns analysis.</p>
</div>
</section>
<section id="network-constrained-point-processes" class="level2">
<h2 class="anchored" data-anchor-id="network-constrained-point-processes">Network Constrained Point Processes</h2>
<p>Many real world point event are not randomly distributed. Their distribution, on the other hand, are constrained by network such as roads, rivers, and fault lines just to name a few of them.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Road traffic accidents within Bangkok City. <img src="img/image3-1.jpg" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p>Location of banks at Central, Hong Kong <img src="img/image3-2.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="network-constrained-kernel-density-estimation-nkde" class="level2">
<h2 class="anchored" data-anchor-id="network-constrained-kernel-density-estimation-nkde">Network Constrained Kernel Density Estimation (NKDE)</h2>
<p>Network Kernel Density Estimation, in short, NKDE is a geospatial analytics methods specially designed to computer intensity of spatial point event either located along or occurred along linear networks.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Mathematically, NKDE can be defined as: <img src="img/image3-3a.jpg" class="img-fluid"></p>
<p>where K must be a probability density function and verifies the two following conditions:</p>
<p><img src="img/image3-3b.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="network-constrained-kernel-density-estimation-nkde-1" class="level2">
<h2 class="anchored" data-anchor-id="network-constrained-kernel-density-estimation-nkde-1">Network Constrained Kernel Density Estimation (NKDE)</h2>
<section id="planar-kde-versus-nkde" class="level3">
<h3 class="anchored" data-anchor-id="planar-kde-versus-nkde">Planar KDE versus NKDE</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>Figure on the right shows the basic differences between the Planar KDE and Network KDE for the same spatial point event data. To estimate th density values at a focal point X, the planar KDE treats the whole 2-D space as the context and finds four point events (black circle) within a search bandwidth (i.e.&nbsp;h), whereas the Network KDE only finds two point events within the same bandwidth in the network space based on network distance.</p>
</div><div class="column" style="width:50%;">
<p><img src="img/image3-3c.jpg" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
<section id="network-constrained-kernel-density-estimation-nkde-method" class="level3">
<h3 class="anchored" data-anchor-id="network-constrained-kernel-density-estimation-nkde-method">Network Constrained Kernel Density Estimation (NKDE) method</h3>
<p>To calculate a Network Kernel Density Estimate (NKDE), it is possible to:</p>
<ul>
<li><p>use lixels instead of pixels. A lixel is a linear equivalent of a pixel on a network. The lines of the network are split into lixels according to a chosen resolution. The centres of the lixels are sampling points for which the density will be estimated.</p></li>
<li><p>calculate network distances between objects instead of Euclidean distances.</p></li>
<li><p>adjust the kernel function to deal with the anisotropic space</p></li>
</ul>
<hr>
</section>
<section id="nkde-method" class="level3">
<h3 class="anchored" data-anchor-id="nkde-method">NKDE Method</h3>
<ul>
<li>To perform a NKDE, the events must be snapped on the network. The snapped events are shown here in green.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="img/image3-4a.jpg" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p><img src="img/image3-4b.jpg" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
<section id="nkde-method-1" class="level3">
<h3 class="anchored" data-anchor-id="nkde-method-1">NKDE Method</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>The mass of each event can be seen as a third dimension and is evaluated by a selected kernel function (K) within a specified bandwidth. The kernel function must satisfy the following conditions:</p>
<p><img src="img/image3-5a.jpg" width="480" height="185"></p>
<p>The total mass of an event is 1, and is spread according to the function <em>K</em> within the bandwidth.</p>
</div><div class="column" style="width:50%;">
<p>In the figure below, we can see that the “influence” of each point is limited within the bandwidth and decreases when we move away from the event.</p>
<p><img src="img/image3-5b.jpg" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
<section id="nkde-method-2" class="level3">
<h3 class="anchored" data-anchor-id="nkde-method-2">NKDE Method</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>With this method, one can evaluate the density of the studied phenomenon at each location on the network. In the figure below, 3 sampling points (s1, s2 and s3) are added in blue.</p>
<p><img src="img/image3-6a.jpg" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p>Where S1, S2, and S3 are calculated by using the formulas below:</p>
<p><img src="img/image3-6b.jpg" class="img-fluid" width="640"></p>
<p>and the general formular will be defined as:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/image3-6c.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="450"></p>
</figure>
</div>
<p>with 𝒅<sub>𝑠𝑖</sub> the density estimated at the sample point 𝑠𝒊, 𝒃𝑤 the bandwidth and 𝑒𝑗 an event.</p>
</div>
</div>
<hr>
</section>
<section id="nkde-method-3" class="level3">
<h3 class="anchored" data-anchor-id="nkde-method-3">NKDE Method</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>The proposed kernel functions in the spNetwork package are:</p>
<p><img src="img/image3-7a.jpg" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p><img src="img/image3-7b.jpg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="the-three-version-of-nkde" class="level2">
<h2 class="anchored" data-anchor-id="the-three-version-of-nkde">The Three version of NKDE</h2>
<section id="simple-method" class="level3">
<h3 class="anchored" data-anchor-id="simple-method">Simple method</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>The first method was proposed by Xie and Yan (2008). Considering the planar KDE, they defined the NKDE with the following formula:</p>
<p><img src="img/image3-8a.jpg" class="img-fluid"></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/image3-8b.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This method remains useful for two reasons:</p>
<ul>
<li><p>For quick data visualization. With big datasets, it might be useful to use this simple method to do a primary investigation.</p></li>
<li><p>In a purely geographical view, this method is intuitive. In the case of crime analysis for example, one could argue that the strength of an event should not be affected by intersections on the network. In that case, the kernel function is seen as a distance decaying function.</p></li>
</ul>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="the-three-version-of-nkde-1" class="level2">
<h2 class="anchored" data-anchor-id="the-three-version-of-nkde-1">The Three version of NKDE</h2>
<section id="discontinuous-method" class="level3">
<h3 class="anchored" data-anchor-id="discontinuous-method">Discontinuous method</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>This method is introduced by Okabe and Sugihara (2012). The discontinuous NKDE is easily presented by a figure:</p>
<p><img src="img/image3-9a.jpg" class="img-fluid"> Note that the density of the kernel function is equally divided at intersections.</p>
</div><div class="column" style="width:50%;">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>As one can see, the values of the NKDE are split at intersections to avoid the multiplication of the mass observed in the simple version. However, this creates a discontinuous NKDE, which is counter-intuitive. It leads to sharp differences between density values in the network, and could be problematic in networks with many intersections.</p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="the-three-version-of-nkde-2" class="level2">
<h2 class="anchored" data-anchor-id="the-three-version-of-nkde-2">The Three version of NKDE</h2>
<section id="continue-method" class="level3">
<h3 class="anchored" data-anchor-id="continue-method">Continue method</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p>The method merges the best of the two worlds: it adjusts the values of the NKDE at intersections to ensure that it integrates to 1 on its domain, and applies a backward correction to force the density values to be continuous.</p>
<p>This process is accomplished by a recursive function. This function is more time consuming, so it might be necessary to stop it when the recursion is too deep. Considering that the kernel density is divided at each intersection, stopping the function at deep level 16 should give results almost identical to the true values.</p>
</div><div class="column" style="width:50%;">
<p><img src="img/image3-10a.jpg" class="img-fluid"></p>
<p>Note that there are three different equations to calculate the kernel density depending on the situation (here, q1, q2, q3).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As one can see, the values of the NKDE are continuous, and the density values close to the events have been adjusted. This leads to smoother results than the discontinuous method.</p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="temporal-network-kernel-density-estimate" class="level2">
<h2 class="anchored" data-anchor-id="temporal-network-kernel-density-estimate">Temporal Network Kernel Density Estimate</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Events recorded on a network often have a temporal dimension. In that context, one could estimate the density of events in both time and network spaces.</p>
<p>The spatio-temporal kernel is calculated as the product of the network kernel density and the time kernel density.</p>
</div><div class="column" style="width:50%;">
<p>For a sample point at location l and time t, the Temporal Network Kernel Density Estimate (TNKDE) is calculated as follows:</p>
<p><img src="img/image4-52a.jpg" class="img-fluid"></p>
<p><img src="img/image4-52b.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><p><a href="https://jeremygelb.github.io/spNetwork/articles/NKDE.html">Network Kernel Density Estimate</a></p></li>
<li><p><a href="https://jeremygelb.github.io/spNetwork/articles/TNKDE.html">Temporal Network Kernel Density Estimate</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>